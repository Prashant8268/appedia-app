<link rel="stylesheet" href="/css/homepage.css">
<div class="container">
    <div class="new-feed">
        <%- include('_createForm') %>

        <h4 id="post-heading">Posts</h4>
        <div class="posts" id="posts-container">
            <% if (posts) { %>
            <% for( let post  of posts) { %>
                <div class="post-card"  id="post-<%= post.id %>">
                    <div>
                        <img src="<%= post.user.avatar %>"  id="user-avatar">
                        <span id="user-name"><%= post.user.name %></span>
                        <% if (locals.user && locals.user.id==post.user.id) { %>         
                        <button>
                            <img src="https://cdn-icons-png.flaticon.com/512/2893/2893795.png" alt="options" >
                        </button>
                        <% } %>
                    </div>
                    <div>
                        <p><%= post.content %></p>
                        <% if (locals.user) { %> 
                            <a href="/likes/toggle?id=<%= post.id %>&type=Post" class="like-tag"> 
                                <img id="like-logo" src="https://cdn-icons-png.flaticon.com/512/1077/1077035.png" alt="like">
                            </a>
                        <% } %>
                        <span><%= post.likes.length %>  &nbsp; Likes</span>
                        <% if (locals.user) { %>
                            <form action="/comments/post-comment" method="POST" class="comment-form" id= "comment-form-<%= post._id %>" >
                                <textarea name="comment" id="" cols="30" rows="2" placeholder="Add comment"></textarea>
                                <input type="hidden" name="post"  value="<%= post._id %>">
                                <input type="submit" value="Comment" class="post-button" id="comment-button">
                            </form>
                        <% } %>
                    </div>
                    <div id="comments-container-<%= post.id %>">
                        <% for( let  comment of post.comments) { %>
                            <li id="comment-<%= post.id  %>">
                            <% if (locals.user &&comment.user.id==locals.user.id ) { %>
                                <small>
                                    <a href="/comments/delete-comment/<%= comment.id %>">
                                    <img src="https://cdn-icons-png.flaticon.com/512/11011/11011600.png" style="height: 15px; width: 8pxpx;">
                                    </a>
                                </small>
                            <% } %>
                                <small><%= comment.user.name %> </small>
                                <small><%= comment.content %> </small>
                                <div>
                                    <a href="/likes/toggle?id=<%= comment._id %>&type=Comment" class="like-tag"> 
                                    <img id="like-logo" src="https://cdn-icons-png.flaticon.com/512/1077/1077035.png" alt="like">
                                    </a>
                                    <span><%= (comment.likes.length) %></span>
                                </div>
                            </li>
                
                        <% } %>
                       </div>
                </div>
                
            <% } %>
            <% } %>
        </div>

    </div>
  

    <div class="side-bar">

        <% if (locals.user) { %>
        <div class="friends">
            <h3>Friends</h3>
        </div>
        <% } %>

        <div class="all-users">
            <% if (users && locals.user) { %>
                <h3>All Users</h3>
            <% for( let i of users) { %>
            <a href="/user/profile-update/<%= i.id %>" > <p><%=  i.name %></p> </a>
            <% } %>
            <% } %>
        </div>

    </div>
</div>
<script src="/js/home_post.js"></script>


